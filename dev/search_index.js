var documenterSearchIndex = {"docs":
[{"location":"api/#API","page":"API","title":"API","text":"","category":"section"},{"location":"api/#Types","page":"API","title":"Types","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"SqrtRational","category":"page"},{"location":"api/#CGcoefficient.SqrtRational","page":"API","title":"CGcoefficient.SqrtRational","text":"SqrtRational <: Real\n\nStore exact value of a Rational's square root. It is stored in s√r format, and we do not simplify it during arithmetics. You can use the simplify function to simplify it.\n\n\n\n\n\n","category":"type"},{"location":"api/#Some-useful-function","page":"API","title":"Some useful function","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"iphase\nis_same_parity\ncheck_jm\ncheck_couple\nbinomial_data_size\nbinomial_index\ncheck_CG\ncheck_3j\ncheck_6j\ncheck_9j\nexact_sqrt\nfloat(::SqrtRational)\nsimplify(::Integer)\nsimplify(::SqrtRational)","category":"page"},{"location":"api/#CGcoefficient.iphase","page":"API","title":"CGcoefficient.iphase","text":"iphase(n::Integer)\n\n(-1)^n\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.is_same_parity","page":"API","title":"CGcoefficient.is_same_parity","text":"is_same_parity(x::T, y::T) where {T <: Integer}\n\njudge if two integers are same odd or same even\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.check_jm","page":"API","title":"CGcoefficient.check_jm","text":"check_jm(dj::T, dm::T) where {T <: Integer}\n\ncheck if the m-quantum number if one of the components of the j-quantum number, in other words, m and j has the same parity, and abs(m) < j\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.check_couple","page":"API","title":"CGcoefficient.check_couple","text":"check_couple(dj1::T, dj2::T, dj3::T) where {T <: Integer}\n\ncheck if three angular monentum number j1, j2, j3 can couple\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.binomial_data_size","page":"API","title":"CGcoefficient.binomial_data_size","text":"binomial_data_size(n::Int)::Int\n\nStore (half) binomial data in the order of\n\n# n - data\n  0   1\n  1   1\n  2   1 2\n  3   1 3\n  4   1 4 6\n  5   1 5 10\n  6   1 6 15 20\n\nReturn the total number of the stored data.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.binomial_index","page":"API","title":"CGcoefficient.binomial_index","text":"binomial_index(n::Int, k::Int)::Int\n\nReturn the index of the binomial coefficient in the table.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.check_CG","page":"API","title":"CGcoefficient.check_CG","text":"check_CG(dj1::T, dj2::T, dj3::T, dm1::T, dm2::T, dm3::T) where {T <: Integer}\n\nCheck if the Clebsch-Gordan coefficient is valid.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.check_3j","page":"API","title":"CGcoefficient.check_3j","text":"check_3j(dj1::T, dj2::T, dj3::T, dm1::T, dm2::T, dm3::T) where {T <: Integer}\n\nCheck if the Wigner 3-j symbol is valid.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.check_6j","page":"API","title":"CGcoefficient.check_6j","text":"check_6j(dj1::T, dj2::T, dj3::T, dj4::T, dj5::T, dj6::T) where {T <: Integer}\n\nCheck if the Wigner 6-j symbol is valid.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.check_9j","page":"API","title":"CGcoefficient.check_9j","text":"check_9j(dj1::T, dj2::T, dj3::T, dj4::T, dj5::T, dj6::T, dj7::T, dj8::T, dj9::T) where {T <: Integer}\n\nCheck if the Wigner 9-j symbol is valid.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.exact_sqrt","page":"API","title":"CGcoefficient.exact_sqrt","text":"exact_sqrt(r::Union{Integer, Rational})\n\nGet exact √r using SqrtRational type.\n\n\n\n\n\n","category":"function"},{"location":"api/#Base.float-Tuple{SqrtRational}","page":"API","title":"Base.float","text":"float(x::SqrtRational)::BigFloat\n\nConvert a SqrtRational to BigFloat.\n\n\n\n\n\n","category":"method"},{"location":"api/#CGcoefficient.simplify-Tuple{Integer}","page":"API","title":"CGcoefficient.simplify","text":"simplify(n::Integer)\n\nSimplify a integer n = x * t^2 to (x, t)\n\n\n\n\n\n","category":"method"},{"location":"api/#CGcoefficient.simplify-Tuple{SqrtRational}","page":"API","title":"CGcoefficient.simplify","text":"simplify(x::SqrtRational)\n\nSimplify a SqrtRational.\n\n\n\n\n\n","category":"method"},{"location":"api/#Exact-functions","page":"API","title":"Exact functions","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"The default functions give out exact result in the format of SqrtRational. The results are simplified to give out shotest possible result. Their arguments are Real (but only allow twice of which can be convert into integer).","category":"page"},{"location":"api/","page":"API","title":"API","text":"CG\nCG0\nthreeJ\nsixJ\nnineJ\nnorm9J\nlsjj\nRacah\nMoshinsky","category":"page"},{"location":"api/#CGcoefficient.CG","page":"API","title":"CGcoefficient.CG","text":"CG(j1::Real, j2::Real, j3::Real, m1::Real, m2::Real, m3::Real)\n\nCG coefficient langle j_1m_1 j_2m_2  j_3m_3 rangle\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.CG0","page":"API","title":"CGcoefficient.CG0","text":"CG0(j1::Integer, j2::Integer, j3::Integer)\n\nCG coefficient special case: langle j_1 0 j_2 0  j_3 0 rangle.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.threeJ","page":"API","title":"CGcoefficient.threeJ","text":"threeJ(j1::Real, j2::Real, j3::Real, m1::Real, m2::Real, m3::Real)\n\nWigner 3j-symbol\n\nbeginpmatrix\nj_1  j_2  j_3 \nm_1  m_2  m_3\nendpmatrix\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.sixJ","page":"API","title":"CGcoefficient.sixJ","text":"sixJ(j1::Real, j2::Real, j3::Real, j4::Real, j5::Real, j6::Real)\n\nWigner 6j-symbol\n\nbeginBmatrix\nj_1  j_2  j_3 \nj_4  j_5  j_6\nendBmatrix\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.nineJ","page":"API","title":"CGcoefficient.nineJ","text":"nineJ(j1::Real, j2::Real, j3::Real,\n      j4::Real, j5::Real, j6::Real,\n      j7::Real, j8::Real, j9::Real)\n\nWigner 9j-symbol\n\nbeginBmatrix\nj_1  j_2  j_3 \nj_4  j_5  j_6 \nj_7  j_8  j_9\nendBmatrix\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.norm9J","page":"API","title":"CGcoefficient.norm9J","text":"norm9J(j1::Real, j2::Real, j3::Real,\n       j4::Real, j5::Real, j6::Real,\n       j7::Real, j8::Real, j9::Real)\n\nnormalized Wigner 9j-symbol\n\nbeginbmatrix\nj_1  j_2  j_3 \nj_4  j_5  j_6 \nj_7  j_8  j_9\nendbmatrix = sqrt(2j_3+1)(2j_6+1)(2j_7+1)(2j_8+1) beginBmatrix\nj_1  j_2  j_3 \nj_4  j_5  j_6 \nj_7  j_8  j_9\nendBmatrix\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.lsjj","page":"API","title":"CGcoefficient.lsjj","text":"lsjj(l1::Integer, l2::Integer, j1::Real, j2::Real, L::Integer, S::Integer, J::Integer)\n\nLS-coupling to jj-coupling transformation coefficient\n\nlangle l_1l_2Ls_1s_2SJl_1s_1j_1l_2s_2j_2Jrangle = beginbmatrixl_1  s_1  j_1  l_2  s_2  j_2  L  S  Jendbmatrix\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.Racah","page":"API","title":"CGcoefficient.Racah","text":"Racah(j1::Real, j2::Real, j3::Real, j4::Real, j5::Real, j6::Real)\n\nRacah coefficient\n\nW(j_1j_2j_3j_4 j_5j_6) = (-1)^j_1+j_2+j_3+j_4 beginBmatrix\nj_1  j_2  j_5 \nj_4  j_3  j_6\nendBmatrix\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.Moshinsky","page":"API","title":"CGcoefficient.Moshinsky","text":"Moshinsky(N::Integer, L::Integer, n::Integer, l::Integer, n1::Integer, l1::Integer, n2::Integer, l2::Integer, Λ::Integer)\n\nMoshinsky bracket，Ref: Buck et al. Nuc. Phys. A 600 (1996) 387-402. Since this function is designed for demonstration the exact result, It only calculate the case of tan(beta) = 1.\n\n\n\n\n\n","category":"function"},{"location":"api/","page":"API","title":"API","text":"People often use double of angular momentum quantum number as parameters, so we can use integer as parameters. This package also offers such functions, where the d letter means double. These functions also give out exact SqrtRational results.","category":"page"},{"location":"api/","page":"API","title":"API","text":"dCG\nd3j\nd6j\nd9j\ndRacah","category":"page"},{"location":"api/#CGcoefficient.dCG","page":"API","title":"CGcoefficient.dCG","text":"dCG(dj1::Integer, dj2::Integer, dj3::Integer, dm1::Integer, dm2::Integer, dm3::Integer)\n\nCG coefficient function with double angular monentum number parameters, so that the parameters can be integer. You can calculate dCG(1, 1, 2, 1, 1, 2) to calculate the real CG(1//2, 1//2, 1, 1/2, 1//2, 1)\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.d3j","page":"API","title":"CGcoefficient.d3j","text":"d3j(dj1::Integer, dj2::Integer, dj3::Integer, dm1::Integer, dm2::Integer, dm3::Integer)\n\n3j-symbol function with double angular monentum number parameters, so that the parameters can be integer.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.d6j","page":"API","title":"CGcoefficient.d6j","text":"d6j(dj1::Integer, dj2::Integer, dj3::Integer, dj4::Integer, dj5::Integer, dj6::Integer)\n\n6j-symbol function with double angular monentum number parameters, so that the parameters can be integer.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.d9j","page":"API","title":"CGcoefficient.d9j","text":"d9j(dj1::Integer, dj2::Integer, dj3::Integer,\n    dj4::Integer, dj5::Integer, dj6::Integer,\n    dj7::Integer, dj8::Integer, dj9::Integer)\n\n9j-symbol function with double angular monentum number parameters, so that the parameters can be integer.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.dRacah","page":"API","title":"CGcoefficient.dRacah","text":"dRacah(dj1::Integer, dj2::Integer, dj3::Integer, dj4::Integer, dj5::Integer, dj6::Integer)\n\nRacah coefficient function with double angular momentum parameters, so that the parameters can be integer.\n\n\n\n\n\n","category":"function"},{"location":"api/#float-version-functions","page":"API","title":"float version functions","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Float version functions is always used for numeric calculation. They are designed for fast calculation. You should call wigner_init_float to reserve the inner binomial table. They only resive Integer arguments, thus fCG, f3j, f6j, fRacha, f9j only resive arguements which are double of the exact quantum number. In some functions, e.g. flsjj, some quantum number can be half-integer, the corresponding arguments start with d (which mean double of the quantum number); while some other quantum number must be integer, the corresponding arguments does not starts with d.","category":"page"},{"location":"api/","page":"API","title":"API","text":"wigner_init_float\nfbinomial\nunsafe_fbinomial\nfCG\nfCG0\nfCGspin\nfCG3spin\nf3j\nf6j\nfRacah\nf9j\nfnorm9j\nflsjj\nfMoshinsky\ndfunc","category":"page"},{"location":"api/#CGcoefficient.wigner_init_float","page":"API","title":"CGcoefficient.wigner_init_float","text":"wigner_init_float(n::Integer, mode::AbstractString, rank::Integer)\n\nWe calculate the Wigner Symbols with binomials. We will store some binomials first, then when we need one binomial, we just load it. In this package, the functions starts with f character dependent on the stored binomials. The wigner_init_float function is used to extend the range of the stored binomial table.\n\nThe parameters means:\n\nmode:\n\"Jmax\": set the maximum angular momentum in the system.\n\"2bjmax\": set the maximum two-body coupled angular momentum in the system.\n\"nmax\": directly set the maximum binomial number.\nn: the maximum angular momentum or the maximum binomial number, dependent on the mode.\nrank:\n3: calculate only CG coefficients and 3j symbols.\n6: calculate CG coefficients, 3j symbols and 6j symbols.\n9: calculate CG coefficients, 3j symbols, 6j symbols and 9j symbols.\n\n\"Jmax\" means the global maximum angular momentum, for every parameters. It is always safe with out any assumption.\n\nThe \"2bjmax\" mode means your calculation only consider two-body coupling, and no three-body coupling. This mode assumes that in all these coefficients, at least one of the angular momentun is just a single particle angular momentum. With this assumption, \"2bjmax\" mode will use less memory than \"Jmax\" mode.\n\nThe \"nmax\" mode directly set nmax, and the rank parameter is ignored. \n\nFor example\n\nwigner_init_float(21, \"Jmax\", 6)\n\nmeans you calculate CG and 6j symbols, and donot calculate 9j symbol. The maximum angular momentum in your system is 21.\n\nThe exact values of the maximum 'nmaxfor differentrank` are shown in the table below (details).\n\n Calculate range CG & 3j 6j & Racah 9j\nmeaning of type type\\rank 3 6 9\nmax angular momentum \"Jmax\" 3*Jmax+1 4*Jmax+1 5*Jmax+1\nmax two-body coupled angular momentum \"2bjmax\" 2*jmax+1 3*jmax+1 4*jmax+1\nmax binomial \"nmax\" nmax namx nmax\n\nYou do not need to rememmber those values in the table. You just need to find the maximum angular momentum in you canculation, then call the function.\n\nThe wigner_init_float function is not thread safe, so you should call it before you start your calculation.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.fbinomial","page":"API","title":"CGcoefficient.fbinomial","text":"fbinomial(n::Integer, k::Integer)\n\nbinomial with Float64 return value.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.unsafe_fbinomial","page":"API","title":"CGcoefficient.unsafe_fbinomial","text":"function unsafe_fbinomial(n::Int, k::Int)\n\nSame as fbinomial, but without bounds check. Thus for n < 0 or n > _nmax or k < 0 or k > n, the result is undefined. In Wigner symbol calculation, the mathematics guarantee that unsafe_fbinomial(n, k) is always safe.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.fCG","page":"API","title":"CGcoefficient.fCG","text":"fCG(dj1::Integer, dj2::Integer, dj3::Integer, dm1::Integer, dm2::Integer, dm3::Integer)\n\nfloat64 and fast CG coefficient.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.fCG0","page":"API","title":"CGcoefficient.fCG0","text":"fCG0(dj1::Integer, dj2::Integer, dj3::Integer)\n\nfloat64 and fast CG coefficient for m1 == m2 == m3 == 0.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.fCGspin","page":"API","title":"CGcoefficient.fCGspin","text":"fCGspin(ds1::Integer, ds2::Integer, S::Integer)\n\nfloat64 and fast CG coefficient for two spin-1/2 coupling.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.fCG3spin","page":"API","title":"CGcoefficient.fCG3spin","text":"fCG3spin(ds1::Integer, ds2::Integer, ds3::Integer, S12::Integer, dS::Integer)\n\nfloat64 and fast CG coefficient for three spin-1/2 coupling: <S12,M12|1/2,m1;1/2,m2><S,M|S12,M12;1/2,m3>\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.f3j","page":"API","title":"CGcoefficient.f3j","text":"f3j(dj1::Integer, dj2::Integer, dj3::Integer, dm1::Integer, dm2::Integer, dm3::Integer)\n\nfloat64 and fast Wigner 3j symbol.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.f6j","page":"API","title":"CGcoefficient.f6j","text":"f6j(dj1::Integer, dj2::Integer, dj3::Integer, dj4::Integer, dj5::Integer, dj6::Integer)\n\nfloat64 and fast Wigner 6j symbol.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.fRacah","page":"API","title":"CGcoefficient.fRacah","text":"Racah(dj1::Integer, dj2::Integer, dj3::Integer, dj4::Integer, dj5::Integer, dj6::Integer)\n\nfloat64 and fast Racah coefficient.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.f9j","page":"API","title":"CGcoefficient.f9j","text":"f9j(dj1::Integer, dj2::Integer, dj3::Integer,\n    dj4::Integer, dj5::Integer, dj6::Integer,\n    dj7::Integer, dj8::Integer, dj9::Integer)\n\nfloat64 and fast Wigner 9j symbol.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.fnorm9j","page":"API","title":"CGcoefficient.fnorm9j","text":"fnorm9j(dj1::Integer, dj2::Integer, dj3::Integer,\n        dj4::Integer, dj5::Integer, dj6::Integer,\n        dj7::Integer, dj8::Integer, dj9::Integer)\n\nfloat64 and fast normalized Wigner 9j symbol.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.flsjj","page":"API","title":"CGcoefficient.flsjj","text":"lsjj(l1::Integer, l2::Integer, dj1::Integer, dj2::Integer, L::Integer, S::Integer, J::Integer)\n\nfloat64 and fast lsjj coefficient.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.fMoshinsky","page":"API","title":"CGcoefficient.fMoshinsky","text":"fMoshinsky(N::Integer, L::Integer, n::Integer, l::Integer, n1::Integer, l1::Integer, n2::Integer, l2::Integer, tanβ::Float64 = 1.0)\n\nfloat64 and fast Moshinsky bracket.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.dfunc","page":"API","title":"CGcoefficient.dfunc","text":"dfunc(dj::Integer, dm1::Integer, dm2::Integer, β::Float64)\n\nWigner d-function.\n\n\n\n\n\n","category":"function"},{"location":"api/#prime-factorization-version","page":"API","title":"prime factorization version","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"I implement a primary version of the prime factorization algorithm, based on the wigxjpf library.","category":"page"},{"location":"api/","page":"API","title":"API","text":"PFRational\ngcd(::PFRational, ::PFRational)\nlcm(::PFRational, ::PFRational)\nwigner_init_pf\npf_binomial\neCG\neCG0\ne3j\ne6j\nefCG\nefCG0\nef3j\nef6j","category":"page"},{"location":"api/#CGcoefficient.PFRational","page":"API","title":"CGcoefficient.PFRational","text":"PFRational{T<:Integer} <: Real\n\nA positive rational number in prime factorization form.\n\nq = prod_i=1^n p_i^e_i\n\nwhere p_i is the i-th prime number and e_i can be negative.\n\n\n\n\n\n","category":"type"},{"location":"api/#Base.gcd-Tuple{PFRational, PFRational}","page":"API","title":"Base.gcd","text":"gcd(x::PFRational, y::PFRational)\n\ngcd of rational means gcd of numerator and lcm of denominator\n\n\n\n\n\n","category":"method"},{"location":"api/#Base.lcm-Tuple{PFRational, PFRational}","page":"API","title":"Base.lcm","text":"lcm(x::PFRational, y::PFRational)\n\nlcm of rational means lcm of numerator and gcd of denominator\n\n\n\n\n\n","category":"method"},{"location":"api/#CGcoefficient.wigner_init_pf","page":"API","title":"CGcoefficient.wigner_init_pf","text":"wigner_init_pf(n::Integer, mode::AbstractString, rank::Integer)\n\nInitialize the prime factorization tables for Wigner symbols. The parameters are similar to wigner_inif_float. You must call this function before using the e and ef versions of Wigner symbols.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.pf_binomial","page":"API","title":"CGcoefficient.pf_binomial","text":"pf_binomial(n::Integer, k::Integer)::PFRational{Int16}\n\nReturn the stored binomial coefficient C(n, k) in prime factorization form.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.eCG","page":"API","title":"CGcoefficient.eCG","text":"eCG(dj1::Integer, dj2::Integer, dj3::Integer, dm1::Integer, dm2::Integer, dm3::Integer)::SqrtRational{BigInt}\n\nExact CG coefficient using prime factorization algorithm.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.eCG0","page":"API","title":"CGcoefficient.eCG0","text":"eCG0(j1::Integer, j2::Integer, j3::Integer)::SqrtRational{BigInt}\n\nExact CG coefficient (m1 = m2 = m3 = 0) using prime factorization algorithm.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.e3j","page":"API","title":"CGcoefficient.e3j","text":"e3j(dj1::Integer, dj2::Integer, dj3::Integer, dm1::Integer, dm2::Integer, dm3::Integer)::SqrtRational{BigInt}\n\nExact 3j symbol using prime factorization algorithm.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.e6j","page":"API","title":"CGcoefficient.e6j","text":"e6j(j1::Integer, j2::Integer, j3::Integer, j4::Integer, j5::Integer, j6::Integer)::SqrtRational{BigInt}\n\nExact 6j symbol using prime factorization algorithm.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.efCG","page":"API","title":"CGcoefficient.efCG","text":"efCG(dj1::Integer, dj2::Integer, dj3::Integer, dm1::Integer, dm2::Integer, dm3::Integer)::Float64\n\nExact CG coefficient (Float64) using prime factorization algorithm.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.efCG0","page":"API","title":"CGcoefficient.efCG0","text":"efCG0(j1::Integer, j2::Integer, j3::Integer)::Float64\n\nExact CG coefficient (m1 = m2 = m3 = 0) (Float64) using prime factorization algorithm.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.ef3j","page":"API","title":"CGcoefficient.ef3j","text":"ef3j(dj1::Integer, dj2::Integer, dj3::Integer, dm1::Integer, dm2::Integer, dm3::Integer)::Float64\n\nExact 3j symbol (Float64) using prime factorization algorithm.\n\n\n\n\n\n","category":"function"},{"location":"api/#CGcoefficient.ef6j","page":"API","title":"CGcoefficient.ef6j","text":"ef6j(j1::Integer, j2::Integer, j3::Integer, j4::Integer, j5::Integer, j6::Integer)::Float64\n\nExact 6j symbol (Float64) using prime factorization algorithm.\n\n\n\n\n\n","category":"function"},{"location":"lsjj/#LS-jj-recoupling","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"","category":"section"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"By defination","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"beginaligned\nmathrmlsjj(l_1j_1l_2j_2LSJ) = langle l_1l_2Ls_1s_2SJl_1s_1j_1l_2s_2j_2Jrangle \n= beginbmatrixl_1  s_1  j_1  l_2  s_2  j_2  L  S  Jendbmatrix \n= sqrt(2j_1+1)(2j_2+1)(2L+1)(2S+1)beginBmatrixl_1  s_1  j_1  l_2  s_2  j_2  L  S  JendBmatrix\nendaligned","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"We only deal with s_1 = s_2 = 12 condition.","category":"page"},{"location":"lsjj/#S-0","page":"LS-jj recoupling","title":"S = 0","text":"","category":"section"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"Ref [1] P357, 10.9.1, (1).","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"beginBmatrixl_1  s_1  j_1  l_2  s_2  j_2  J  0  JendBmatrix = dfrac(-1)^l_1+s_1+j_2+Jsqrt2(2J+1) beginBmatrixl_1  s_1  j_1  j_2  J  l_2endBmatrix","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"So","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"beginbmatrixl_1  s_1  j_1  l_2  s_2  j_2  J  0  Jendbmatrix = (-1)^l_1+s_1+j_2+Jsqrtdfrac(2j_1+1)(2j_2+1)2 beginBmatrixl_1  s_1  j_1  j_2  J  l_2endBmatrix","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"Here we define","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"H_J(l_1l_2j_1j_2) equiv (-1)^l_1+frac12+j_2+Jsqrtdfrac(2j_1+1)(2j_2+1)2 beginBmatrixl_1  frac12  j_1  j_2  J  l_2endBmatrix","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"It is useful in laster formula.","category":"page"},{"location":"lsjj/#S-1","page":"LS-jj recoupling","title":"S = 1","text":"","category":"section"},{"location":"lsjj/#L-J","page":"LS-jj recoupling","title":"L = J","text":"","category":"section"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"Ref [1] P358, 10.9.2, (6).","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"beginBmatrixl_1  s_1  j_1  l_2  s_2  j_2  J  1  JendBmatrix = (-1)^l_1+s_1+j_2+Jfrac(j_1-j_2)(j_1+j_2+1) - (l_1-l_2)(l_1+l_2+1)sqrt6J(J+1)(2J+1)beginBmatrixl_1  frac12  j_1  j_2  J  l_2endBmatrix","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"So","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"beginbmatrixl_1  s_1  j_1  l_2  s_2  j_2  J  1  Jendbmatrix = frac(j_1-j_2)(j_1+j_2+1) - (l_1-l_2)(l_1+l_2+1)sqrtJ(J+1) H_J(l_1l_2j_1j_2)","category":"page"},{"location":"lsjj/#J-L-1","page":"LS-jj recoupling","title":"J = L + 1","text":"","category":"section"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"Ref [1] P358, 10.9.2, (7).","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"beginaligned\n(-1)^l_1+s_1+j_2+J-1sqrt6J(2J-1)(2J+1)beginBmatrixl_1  s_1  j_1  l_2  s_2  j_2  J-1  1  JendBmatrix \n= sqrt(j_1-j_2+J)(j_2-j_1+J)(j_1+j_2+J+1)(j_1+j_2-J+1)beginBmatrixl_1  frac12  j_1  j_2  J-1  l_2endBmatrix \n + sqrt(l_1-l_2+J)(l_2-l_1+J)(l_1+l_2+J+1)(l_1+l_2-J+1) beginBmatrixl_1  frac12  j_1  j_2  J  l_2endBmatrix\nendaligned","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"So","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"beginaligned\nbeginBmatrixl_1  s_1  j_1  l_2  s_2  j_2  J-1  1  JendBmatrix = sqrtfrac(j_1-j_2+J)(j_2-j_1+J)(j_1+j_2+J+1)(j_1+j_2-J+1)J(2J+1)H_J-1(l_1l_2j_1j_2) \n-sqrtfrac(l_1-l_2+J)(l_2-l_1+J)(l_1+l_2+J+1)(l_1+l_2-J+1)J(2J+1) H_J(l_1l_2j_1j_2)\nendaligned","category":"page"},{"location":"lsjj/#J-L-1-2","page":"LS-jj recoupling","title":"J = L - 1","text":"","category":"section"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"Ref [1] P358, 10.9.2, (7).","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"beginaligned\n(-1)^l_1+s_1+j_2+Jsqrt6J(2J+1)(2J+3)beginBmatrixl_1  s_1  j_1  l_2  s_2  j_2  J-1  1  JendBmatrix \n=sqrt(j_1-j_2+L)(j_2-j_1+L)(j_1+j_2+L+1)(j_1+j_2-L+1) beginBmatrixl_1  frac12  j_1  j_2  J+1  l_2endBmatrix \n+sqrt(l_1-l_2+L)(l_2-l_1+L)(l_1+l_2+L+1)(l_1+l_2-L+1) beginBmatrixl_1  frac12  j_1  j_2  J  l_2endBmatrix\nendaligned","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"So","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"beginaligned\nbeginBmatrixl_1  s_1  j_1  l_2  s_2  j_2  J+1  1  JendBmatrix \n=sqrtfrac(l_1-l_2+L)(l_2-l_1+L)(l_1+l_2+L+1)(l_1+l_2-L+1)(J+1)(2J+1) H_J(l_1l_2j_1j_2) \n- sqrtfrac(j_1-j_2+L)(j_2-j_1+L)(j_1+j_2+L+1)(j_1+j_2-L+1)(J+1)(2J+1)H_J+1(l_1l_2j_1j_2)\nendaligned","category":"page"},{"location":"lsjj/#H-function","page":"LS-jj recoupling","title":"H function","text":"","category":"section"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"According to the symmetry of Wigner-6j symbol, one can find","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"H_J(l_1l_2j_1j_2) = (-1)^l_1+l_2+j_1+j_2+1 H_J(l_2l_1j_2j_1)","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"j_1 = l_1 + frac12 j_2 = l_2 + frac12","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"Ref [1] P300, 9.5.2, (5).","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"H_J(l_1l_2j_1j_2) = sqrtdfrac(j_1+j_2+J+1)(j_1+j_2-J)8j_1j_2","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"j_1 = l_1 + frac12 j_2 = l_2 - frac12","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"Ref [1] P300, 9.5.2, (4).","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"H_J(l_1l_2j_1j_2) = sqrtdfrac(j_1-j_2+J)(j_2-j_1+J+1)8j_1(j_2+1)","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"j_1 = l_1 - frac12 j_2 = l_2 + frac12","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"H_J(l_1l_2j_1j_2) = -sqrtdfrac(j_1-j_2+J+1)(j_2-j_1+J)8(j_1+1)j_2","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"j_1 = l_1 - frac12 j_2 = l_2 - frac12","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"H_J(l_1l_2j_1j_2) = sqrtdfrac(j_1+j_2+J+2)(j_1+j_2-J+1)8(j_1+1)(j_2+1)","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"Reference","category":"page"},{"location":"lsjj/","page":"LS-jj recoupling","title":"LS-jj recoupling","text":"[1]: A. N. Moskalev D. A. Varshalovich and V. K. Khersonskii, Quantum theory of angular momentum.","category":"page"},{"location":"pfrational/#Prime-Factorization-representation-of-Rational","page":"Prime Factorization","title":"Prime Factorization representation of Rational","text":"","category":"section"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"For any positive integer N in mathbbZ^+, it have a unique prime factorization representation","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"N = prod_ip_i^e_i","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"where i = 1 2 dots infty, p_i are primes, and e_i ge 0. Actually, if we modify this theorem a little, we have the prime factorization representation of rationals:","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"For any positive rational q in mathbbQ^+, it have a unique representation","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"q = prod_ip_i^e_i","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"where i = 1 2 dots infty and e_i in mathbbN can be positve, negative or zero.","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"Using this representation, we can quickly evaluate q_1 cdot q_2 and q_1  q_2:","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"q_1 = prod_ip_i^e_i(1) quad q_2 = prod_ip_i^e_i(2) ","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"q_1cdot q_2 = prod_ip_i^e_i(1)+e_i(2) quad q_1cdot q_2 = prod_ip_i^e_i(1)-e_i(2)","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"We can also define","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"mathrmgcd(q_1 q_2) = prod_ip_i^mine_i(1) e_i(2) quad mathrmlcm(q_1 q_2) = prod_ip_i^maxe_i(1)e_i(2)","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"The prime factorization representation is very suitable for computing the factorial n and binomial tbinomnm. If we known the maximum n in all of the calculations, then the maximum p_i needed in the calculation satisfy p_i le n lt p_i+1.","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"However, in our calculation of Wigner-3nj symbols, we need calculate some addition and subtraction of the numbers. Considering to calculate q_1 + q_2 - q_3, we should first calculate","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"q_g = gcd(q_1 q_2 q_3)","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"Then q_1q_g q_2q_g q_3q_g become integers. Next, we convert them into BigInt and do addition and subtraction.","category":"page"},{"location":"pfrational/#The-maximum-exponent","page":"Prime Factorization","title":"The maximum exponent","text":"","category":"section"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"To convert the prime factorization representation of Rational into Rational{BigInt}, we need to store the pow table of primes to quickly obtain the result of p_i^e_i.","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"Legendre's formula: For any prime number p and any positive integer n, let nu_p(n) be the exponent of the largest power of p that divides n (that is, the p-adic valuation of n). Then","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"nu _p(n)=sum _i=1^infty leftlfloor frac np^irightrfloor","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"Kummer's Theorem: For given integers n ge m ge 0 and a prime number p, the p-adic valuation nu_ptbinomnm of the binomial coefficient tbinomnm is equal to the number of carries when m is added to n − m in base p.","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"If we use factorial, then for p^a le n lt p^a-1, we have","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"nu_p(n) = 1+p+p^2+cdots +p^a-1 = fracp^a-1p-1","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"For n = p^a p = 2, the maximum exponent needed is n - 1.","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"If we use the binomial, we have","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"sup_0le kle n nu_p(C_n^k) le lfloor log_p n rfloor","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"because the number of carries is never larger than the number of digits of the number n in base p.","category":"page"},{"location":"pfrational/","page":"Prime Factorization","title":"Prime Factorization","text":"For n = p^a p = 2, the maximum exponent needed is lfloor log_2 n rfloor.","category":"page"},{"location":"#Home","page":"Home","title":"Home","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"A package to calculate CG-coefficient, Racha coefficient, and Wigner 3j, 6j, 9j symbols. We offer two versions of API for all these coefficients.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The exact functions return SqrtRational, which are designed for demonstration. They use BigInt in the internal calculation, and do not cache the binomial table, so they are not efficient.\nThe floating-point functions return Float64, which are designed for numeric calculation. They use Int, Float64 in the internal calculation, and you should pre-call wigner_init_float to calculate and cache the binomial table for later calculation. They may give inaccurate result for vary large angular momentum, due to floating-point arithmetic. You can find the max error at here: wigner-benchmark.","category":"page"},{"location":"#Install","page":"Home","title":"Install","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Just install with Julia REPL and enjoy it.","category":"page"},{"location":"","page":"Home","title":"Home","text":"pkg> add CGcoefficient","category":"page"},{"location":"#Usage","page":"Home","title":"Usage","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"push!(LOAD_PATH, \"../../src/\") # hide","category":"page"},{"location":"","page":"Home","title":"Home","text":"using CGcoefficient\nsixJ(1,2,3,4,5,6)","category":"page"},{"location":"","page":"Home","title":"Home","text":"In a markdown enviroment, such as jupyter notebook, it will give you a latex output. You can also do some arithmetics with the result, thus do arithmetics using the SqrtRational type.","category":"page"},{"location":"","page":"Home","title":"Home","text":"x = sixJ(1,2,3,4,5,6) * exact_sqrt(1//7) * exact_sqrt(1//13) * iphase(2+3+5+6)","category":"page"},{"location":"","page":"Home","title":"Home","text":"The result is not simplified by default, you can use simplify function to simplify it.","category":"page"},{"location":"","page":"Home","title":"Home","text":"simplify(x)","category":"page"},{"location":"","page":"Home","title":"Home","text":"In a console enviroment it will give out a text output.","category":"page"},{"location":"","page":"Home","title":"Home","text":"nineJ(1,2,3,5,4,3,6,6,0)","category":"page"},{"location":"","page":"Home","title":"Home","text":"You can convert a SqrtRational in to BigFloat,","category":"page"},{"location":"","page":"Home","title":"Home","text":"t = sixJ(17/2,9,19/2,15/2,10,15/2)\nfloat(t)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Calling wigner_init_float first to pre-calculate and cache binomial table.","category":"page"},{"location":"","page":"Home","title":"Home","text":"wigner_init_float(10, \"Jmax\", 6)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Then call a float version function","category":"page"},{"location":"","page":"Home","title":"Home","text":"f6j(17,18,19,15,20,15)","category":"page"},{"location":"#About","page":"Home","title":"About","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"This package is inspired by Ref [1]. See CENS-MBPT for details.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The idea is to simplify 3nj Symbols to sum combinations of binomial coefficients. We can calculate binomial coefficients by Pascal's Triangle, and store them first. Then we calculate 3nj Symbols using the stored binomial coefficients.","category":"page"},{"location":"","page":"Home","title":"Home","text":"In this package, we just use the builtin binomial function for exact calculation. Only the float version uses stored binomials.","category":"page"},{"location":"","page":"Home","title":"Home","text":"[1]: T. Engeland and M. Hjorth-Jensen, the Oslo-FCI code. https://github.com/ManyBodyPhysics/CENS.","category":"page"},{"location":"moshinsky/#Moshinsky","page":"Moshinsky","title":"Moshinsky","text":"","category":"section"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"The Talmi-Moshinsky braket can be evaluated as following [1]：","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginaligned\n    langle n_3l_3n_4l_4Lambdan_1l_1n_2l_2Lambdarangle = prod_k=1^4 i^-l_k sqrtdfracn_k2(n_k+l_k)+1sqrt2^l_k \n    times sum_n_an_bn_cn_dl_a l_b l_c l_d Bigg(-1)^l_d (sinbeta)^2n_a + l_a + 2n_d + l_d(cosbeta)^2n_b+l_b + 2n_c + l_c beginBmatrixl_a  l_b  l_1  l_c  l_d  l_2  l_3  l_4  Lambda endBmatrix  \n    times  C_l_a0l_b0^l_10 C_l_a0l_c0^l_30 C_l_b0l_d0^l_40 C_l_c0l_d0^l_20 prod_p = a^d dfrac(-1)^l_psqrt2^l_p(2l_p+1)n_p2(n_p+l_p) + 1 Bigg\nendaligned","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"where","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginaligned\n    2n_a + l_a + 2n_b + l_b = 2n_1 + l_1 equiv f_1 \n    2n_a + l_a + 2n_c + l_c = 2n_3 + l_3 equiv f_3 \n    2n_b + l_b + 2n_d + l_d = 2n_4 + l_4 equiv f_4 \n    2n_c + l_c + 2n_d + l_d = 2n_2 + l_2 equiv f_2\nendaligned","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Here we define chi = f_1 + f_2 = f_3 + f_4。","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Similar as Wigner symbols, we try to rewrite it as binomials. First, we have:","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"    (2k+1) = dfrac(2k+1)(2k) = dfrac(2k+1)2^k k","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"We can rewrite the following term:","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginaligned\n    t_p equiv dfrac(-1)^l_psqrt2^l_p(2l_p+1)n_p2(n_p+l_p) + 1 \n        = dfrac(-1)^l_psqrt2^l_p(2l_p+1)2^n_p+l_p(2n_p+l_p+1)beginpmatrix2n_p+l_p+1  n_pendpmatrix beginpmatrix2(n_p+l_p)+1  n_p + l_pendpmatrix^-1\nendaligned","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Similiarly,","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginaligned\n    r_k equiv dfracn_k2(n_k+l_k)+1sqrt2^l_k \n        = dfrac(2n_k+l_k+2)sqrt2^l_k2^n_k+l_k(n_k+l_k+2)beginpmatrix2(n_k+l_k)+1  n_k + l_kendpmatrixbeginpmatrix2n_k+l_k+2  n_kendpmatrix^-1\nendaligned","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Next,","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginaligned\n    t equiv dfracprod_k=1^4 sqrt(2n_k+l_k+2)prod_p=a^d (2n_p+l_p + 1) \n    = sqrtbeginpmatrix2n_1+l_1+2  2n_a + l_a + 1endpmatrixbeginpmatrix2n_2 + l_2 + 2  2n_c + l_c + 1endpmatrix beginpmatrix2n_3 + l_3 + 2  2n_a + l_a + 1endpmatrixbeginpmatrix2n_4 + l_4 + 2  2n_b + l_b + 1endpmatrix\nendaligned","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"In the prod of t_p, there is","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"    prod_p=a^d sqrt2^l_p2^n_p+l_p = prod_p=a^d 2^frac2n_p+l_p2 2^l_p = 2^chi2 prod_p=a^d 2^l_p","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"In the pord of r_k, there is","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"    sqrtprod_k=1^4 dfrac1sqrt2^l_k2^n_k+l_k = 2^-chi2 prod_k=1^4 2^-l_k2","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Finally, we have","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginaligned\n    langle n_3l_3n_4l_4Lambdan_1l_1n_2l_2Lambdarangle\n    = prod_k=1^4 i^-l_k sqrtdfrac12^l_k(n_k+l_k+2)beginpmatrix2(n_k+l_k)+1  n_k + l_kendpmatrixbeginpmatrix2n_k+l_k+2  n_kendpmatrix^-1 \n    times  sum_n_an_bn_cn_dl_a l_b l_c l_d Bigg(-1)^l_d (sinbeta)^2n_a + l_a + 2n_d + l_d(cosbeta)^2n_b+l_b + 2n_c + l_c beginBmatrixl_a  l_b  l_1  l_c  l_d  l_2  l_3  l_4  Lambda endBmatrix \n    times  sqrtbeginpmatrix2n_1+l_1+2  2n_a + l_a + 1endpmatrixbeginpmatrix2n_2 + l_2 + 2  2n_c + l_c + 1endpmatrix beginpmatrix2n_3 + l_3 + 2  2n_a + l_a + 1endpmatrixbeginpmatrix2n_4 + l_4 + 2  2n_b + l_b + 1endpmatrix \n    times  C_l_a0l_b0^l_10 C_l_a0l_c0^l_30 C_l_b0l_d0^l_40 C_l_c0l_d0^l_20 prod_p=a^d (-1)^l_p2^l_p(2l_p+1)beginpmatrix2n_p+l_p+1  n_pendpmatrix beginpmatrix2(n_p+l_p)+1  n_p + l_pendpmatrix^-1 Bigg\nendaligned","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Consider m_1 = m_2omega_1 = omega_2, thus tanbeta = 1  cosbeta = sinbeta = 1sqrt2, then","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginaligned\n    (sinbeta)^2n_a + l_a + 2n_d + l_d(cosbeta)^2n_b+l_b + 2n_c + l_c = 2^-frac2n_a + l_a + 2n_b + l_b + 2n_c + l_c + 2n_d + l_d2 \n    = 2^-fracf_1+f_22 \n    = 2^-chi2\nendaligned","category":"page"},{"location":"moshinsky/#Exact-evaluation","page":"Moshinsky","title":"Exact evaluation","text":"","category":"section"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Still start from the origin equation, define","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"X_abcd = left(prod_k=1^4 i^-l_kright)left(prod_p = a^d (-1)^l_pright)beginBmatrixl_a  l_b  l_1  l_c  l_d  l_2  l_3  l_4  Lambda endBmatrix C_l_a0l_b0^l_10 C_l_a0l_c0^l_30 C_l_b0l_d0^l_40 C_l_c0l_d0^l_20","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"According to Ref [2], P251, Sec 8.5.2, Formula(32).","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"C^c0_a0b0 = begincases\n0  a + b + c = 2g + 1 \ndfrac(-1)^g-chatcg(g-a)(g-b)(g-c)Delta(abc)  a +b +c = 2g\nendcases","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Define","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Omega(abc) equiv dfracg(g-a)(g-b)(g-c) = frac1(g+1)Delta^2(fraca2fracb2fracc2) = binomgcbinomcg-a","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"It is obvious a integer. Then","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"X_abcd = (-1)^f_xhatl_1hatl_2hatl_3hatl_4Omega(l_al_bl_1)Delta(l_al_bl_1)Omega(l_al_cl_3)Delta(l_al_cl_3)Omega(l_bl_dl_4)Delta(l_bl_dl_4)Omega(l_cl_dl_2)Delta(l_cl_dl_2)beginBmatrixl_a  l_b  l_1  l_c  l_d  l_2  l_3  l_4  Lambda endBmatrix","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"where","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginaligned\nf_x = -fracl_1+l_2+l_3+l_42 + l_a+l_b+l_c+l_d + dfracl_a+l_b-l_12 + dfracl_c+l_d-l_22 + dfracl_a+l_c-l_32 + dfracl_b+l_d-l_42 \n= 2(l_a+l_b+l_c+l_d) - (l_1+l_2+l_3+l_4)\nendaligned","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"It is easy to prove that l_1+l_2+l_3+l_4 is even, so the phase factor of X is 1. In the Wigner symbols section, we have obtain","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginBmatrixl_a  l_b  l_1  l_c  l_d  l_2  l_3  l_4  Lambda endBmatrix = P_0sum_t P(t) left(sum_x A(tx)right) left(sum_y B(ty)right) left(sum_z C(tz)right)","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Where, A(tx) B(ty) C(tz) are all integers, and P(t) is a rational. Here","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"P_0 = fracDelta(l_al_cl_3)Delta(l_bl_dl_4)Delta(l_1l_2Lambda)Delta(l_al_bl_1)Delta(l_cl_dl_2)Delta(l_3l_4Lambda)","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"So","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginaligned\nX_abcd = hatl_1hatl_2hatl_3hatl_4Omega(l_al_bl_1)Omega(l_al_cl_3)Omega(l_bl_dl_4)Omega(l_cl_dl_2) Delta^2(l_al_cl_3)Delta^2(l_bl_dl_4)fracDelta(l_1l_2Lambda)Delta(l_3l_4Lambda) \ntimessum_t P(t) left(sum_x A(tx)right) left(sum_y B(ty)right) left(sum_z C(tz)right)\nendaligned","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"In this formula, the only sqrt occurs in","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"hatl_1hatl_2hatl_3hatl_4fracDelta(l_1l_2Lambda)Delta(l_3l_4Lambda)","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"which is only related to l_1l_2l_3l_4Lambda, and is equal in all the summations. If we only deal with tanbeta = 1, that's (sinbeta)^2n_a + l_a + 2n_d + l_d(cosbeta)^2n_b+l_b + 2n_c + l_c = 2^-chi2, then the Moshinsky braket is a square root of a rational.","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Define","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginaligned\nM_9j(l_al_bl_cl_dl_1l_2l_3l_4Lambda) = Omega(l_al_bl_1)Omega(l_al_cl_3)Omega(l_bl_dl_4)Omega(l_cl_dl_2) Delta^2(l_al_cl_3)Delta^2(l_bl_dl_4)\ntimes sum_t P(t) left(sum_x A(tx)right) left(sum_y B(ty)right) left(sum_z C(tz)right)\nendaligned","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"Then we can finally write down","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"beginaligned\nlangle n_3l_3n_4l_4Lambdan_1l_1n_2l_2Lambdarangle\n= (2n_1+l_1+2)(2n_2+l_2+2)sqrtfracbinomchi+2f_1+1binoml_3+l_4+Lambda+12Lambda+1binom2LambdaLambda + l_3-l_4binomchi+2f_3+1binoml_1+l_2+Lambda+12Lambdabinom2LambdaLambda+l_1-l_2 prod_k^4 sqrt(2l_k+1)fracbinom2(n_i+l_i)+1n_k+l_kbinom2n_k+l_k+1n_k \ntimes sum_n_an_bn_cn_dl_a l_b l_c l_d Bigg(-1)^l_d (sinbeta)^2n_a + l_a + 2n_d + l_d(cosbeta)^2n_b+l_b + 2n_c + l_c M_9j(l_al_bl_cl_dl_1l_2l_3l_4Lambda) \ntimes binom2n_1+l_1+22n_a+l_a+1binom2n_2+l_2+22n_c+l_c+1 2^l_a+l_b+l_c+l_d-fracl_1+l_2+l_3+l_42 prod_p=a^d (2l_p+1) fracbinom2(n_p+l_b)+1n_p+l_pbinom2n_p+l_p+1n_pBigg\nendaligned","category":"page"},{"location":"moshinsky/","page":"Moshinsky","title":"Moshinsky","text":"[1]: Buck et al. Nuc. Phys. A 600 (1996) 387-402.\n[2]: A. N. Moskalev D. A. Varshalovich and V. K. Khersonskii, Quantum theory of angular momentum.","category":"page"},{"location":"wigner/#CG-coefficient-and-Wigner-symbols","page":"Wigner Symbols","title":"CG coefficient and Wigner symbols","text":"","category":"section"},{"location":"wigner/#CG-coefficient","page":"Wigner Symbols","title":"CG coefficient","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Ref [1], P240, Section 8.2.4, Formula (20).","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"C_j_1m_1j_2m_2^j_3m_3 = delta_m_3 m_1+m_2\nleft\n    dfracbeginpmatrix2j_1  J-2j_2endpmatrixbeginpmatrix2j_2J-2j_3endpmatrixbeginpmatrixJ+1J-2j_3endpmatrixbeginpmatrix2j_1j_1-m_1endpmatrixbeginpmatrix2j_2  j_2 - m_2endpmatrixbeginpmatrix2j_3  j_3-m_3endpmatrix\nright^12 \ntimes sum_z (-1)^zbeginpmatrixJ-2j_3  zendpmatrixbeginpmatrixJ-2j_2  j_1-m_1-zendpmatrixbeginpmatrixJ-2j_1  j_2 + m_2 - zendpmatrix","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"where, J = j_1+j_2+j_3. It is already combination of binomials.","category":"page"},{"location":"wigner/#3j-symbol","page":"Wigner Symbols","title":"3j symbol","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Ref [1], P236, Section 8.1.2, Formula (11).","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"beginaligned\nbeginpmatrixj_1  j_2  j_3  m_1  m_2  m_3endpmatrix = (-1)^j_3+m_3+2j_1dfrac1sqrt2j_3+1C_j_1-m_1j_2-m_2^j_3m_3 \n= (-1)^j_3+m_3+2j_1 dfracdelta_-m_3 m_1+m_2sqrtJ+1 sum_z (-1)^zbeginpmatrixJ-2j_3  zendpmatrixbeginpmatrixJ-2j_2  j_1 + m_1-zendpmatrixbeginpmatrixJ-2j_1  j_2 - m_2 - zendpmatrix \ntimes left\n    dfracbeginpmatrix2j_1  J-2j_2endpmatrixbeginpmatrix2j_2J-2j_3endpmatrixbeginpmatrixJJ-2j_3endpmatrixbeginpmatrix2j_1j_1 - m_1endpmatrixbeginpmatrix2j_2  j_2 - m_2endpmatrixbeginpmatrix2j_3  j_3-m_3endpmatrixright^12\nendaligned","category":"page"},{"location":"wigner/#6j-symbol","page":"Wigner Symbols","title":"6j symbol","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Ref [1], P293, Section 9.2.1, Formula (1).","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"beginBmatrixj_1  j_2  j_3  j_4  j_5  j_6endBmatrix = Delta(j_1j_2j_3)Delta(j_4j_5j_3)Delta(j_1j_5j_6)Delta(j_4j_2j_6) \ntimes sumlimits_xdfrac(-1)^x(x+1)(x-j_123)(x-j_453)(x-j_156)(x-j_426)(j_1245-x)(j_1346-x)(j_2356-x)","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Here, I use j_123 equiv j_1+j_2+j_3 for simplicity. The symbol Delta(abc) is defined as","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Delta(abc) = leftdfrac(a+b-c)(a-b+c)(-a+b+c)(a+b+c+1)right^frac12","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"We can find that","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"beginpmatrixj_1+j_2-j_3  x - j_453endpmatrix = dfrac(j_1+j_2-j_3)(x-j_453)(j_1245-x) \nbeginpmatrixj_1-j_2+j_3  x - j_426endpmatrix = dfrac(j_1-j_2+j_3)(x-j_426)(j_1346-x) \nbeginpmatrixj_2+j_3-j_1  x - j_156endpmatrix = dfrac(j_2+j_3-j_1)(x-j_156)(j_2356-x) \nbeginpmatrixx+1  j_123+1endpmatrix = dfrac(x+1)(x-j_123)(j_123+1)","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"So, we have","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"beginBmatrixj_1  j_2  j_3  j_4  j_5  j_6endBmatrix = dfracDelta(j_4j_5j_3)Delta(j_1j_5j_6)Delta(j_4j_2j_6)Delta(j_1j_2j_3) \ntimes sumlimits_x (-1)^x beginpmatrixx+1  j_123+1endpmatrix beginpmatrixj_1+j_2-j_3  x - j_453endpmatrix beginpmatrixj_1-j_2+j_3  x - j_426endpmatrix beginpmatrixj_2+j_3-j_1  x - j_156endpmatrix","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Rewrite Delta(abc) with binomials,","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Delta(abc) = leftdfrac1beginpmatrixa+b+c+1  2a + 1endpmatrix beginpmatrix2a  a + b - cendpmatrix(2a+1)right^frac12","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"So","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"dfracDelta(j_4j_5j_3)Delta(j_1j_5j_6)Delta(j_4j_2j_6)Delta(j_1j_2j_3) \n= dfrac12j_4+1 leftdfracbeginpmatrixj_123+1  2j_1+1endpmatrixbeginpmatrix2j_1  j_1 + j_2 - j_3endpmatrixbeginpmatrixj_156+1  2j_1+1endpmatrixbeginpmatrix2j_1  j_1+j_5-j_6endpmatrixbeginpmatrixj_453+12j_4+1endpmatrixbeginpmatrix2j_4j_4+j_5-j_3endpmatrixbeginpmatrixj_426+1  2j_4+1endpmatrixbeginpmatrix2j_4  j_4+j_2-j_6endpmatrixright^frac12","category":"page"},{"location":"wigner/#Racha-coefficient","page":"Wigner Symbols","title":"Racha coefficient","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Ref [1], P291, Section 9.1.2, Formula (11)","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"W(j_1j_2j_3j_4 j_5j_6) = (-1)^j_1+j_2+j_3+j_4 beginBmatrix\nj_1  j_2  j_5 \nj_4  j_3  j_6\nendBmatrix","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"This package uses the 6j symbol above to calculate Racha coefficient. ","category":"page"},{"location":"wigner/#9j-symbol","page":"Wigner Symbols","title":"9j symbol","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Ref [1], P340, Section 10.2.4, Formula (20)","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"beginBmatrixj_1  j_2  j_3  j_4  j_5  j_6  j_7  j_8  j_9endBmatrix = sumlimits_t(-1)^2t(2t+1)beginBmatrixj_1  j_2  j_3  j_6  j_9  tendBmatrix beginBmatrixj_4  j_5  j_6  j_2  t  j_8endBmatrix beginBmatrixj_7  j_8  j_9  t  j_1  j_4endBmatrix","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Use the 6j symbol result above, we get","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"dfracDelta(j_1j_9t)Delta(j_6j_9j_3)Delta(j_6j_2t)Delta(j_1j_2j_3) dfracDelta(j_4tj_8)Delta(j_2tj_6)Delta(j_2j_5j_8)Delta(j_4j_5j_6) dfracDelta(j_7j_1j_4)Delta(tj_1j_9)Delta(tj_8j_4)Delta(j_7j_8j_9) \n = dfracDelta(j_3j_6j_9)Delta(j_2j_5j_8)Delta(j_1j_4j_7)Delta(j_1j_2j_3)Delta(j_4j_5j_6)Delta(j_7j_8j_9) Delta^2(j_1j_9t)Delta^2(j_2j_6t)Delta^2(j_4j_8t)","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Define","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"P_0 equiv dfracDelta(j_3j_6j_9)Delta(j_2j_5j_8)Delta(j_1j_4j_7)Delta(j_1j_2j_3)Delta(j_4j_5j_6)Delta(j_7j_8j_9) \n= leftdfracbeginpmatrixj_123 + 1  2j_1+1endpmatrixbeginpmatrix2j_1j_1+j_2-j_3endpmatrixbeginpmatrixj_456+12j_5+1endpmatrixbeginpmatrix2j_5  j_4+j_5-j_6endpmatrixbeginpmatrixj_789+1  2j_9+1endpmatrixbeginpmatrix2j_9  j_7 + j_9 - j_8endpmatrixbeginpmatrixj_147 + 1 2j_1 + 1endpmatrixbeginpmatrix2j_1  j_1+j_4-j_7endpmatrixbeginpmatrixj_258+1  2j_5+1endpmatrixbeginpmatrix2j_5  j_2+j_5 - j_8endpmatrixbeginpmatrixj_369+1  2j_9+1endpmatrixbeginpmatrix2j_9  j_3+j_9 - j_6endpmatrixright^12","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"and then define","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"P(t) equiv (-1)^2t(2t+1)Delta^2(j_1j_9t)Delta^2(j_2j_6t)Delta^2(j_4j_8t)\n = dfrac(-1)^2t(2t+1)^2 times \n\ndfrac1beginpmatrixj_1+j_9+t+1  2t+1endpmatrixbeginpmatrix2t  j_1+t-j_9endpmatrixbeginpmatrixj_2+j_6+t+1  2t+1endpmatrixbeginpmatrix2t  j_2+t-j_6endpmatrixbeginpmatrixj_4+j_8+t  2t+1endpmatrixbeginpmatrix2t  j_4+t-j_8endpmatrix","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"A(tx) equiv (-1)^xbeginpmatrixx+1  j_123 + 1endpmatrixbeginpmatrixj_1+j_2-j_3  x - (j_6+j_9+j_3)endpmatrix beginpmatrixj_1+j_3-j_2  x - (j_6+j_2+t)endpmatrixbeginpmatrixj_2+j_3-j_1  x - (j_1 + j_9 + t)endpmatrix","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"B(ty) equiv (-1)^ybeginpmatrixy+1  j_456 + 1endpmatrixbeginpmatrixj_4+j_5-j_6  y - (j_2+t+j_6)endpmatrixbeginpmatrixj_4+j_6-j_5  y - (j_2+j_5+j_8)endpmatrixbeginpmatrixj_5+j_6-j_4  y - (j_4+t+j_8)endpmatrix","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"C(tz) equiv (-1)^z beginpmatrixz+1  j_789 + 1endpmatrixbeginpmatrixj_7+j_8-j_9  z - (t+j_1+j_9)endpmatrixbeginpmatrixj_7+j_9-j_8  z - (t+j_8+j_4)endpmatrixbeginpmatrixj_8+j_9- j_7  z - (j_7 + j_1 + j_4)endpmatrix","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"At last, we get","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"beginBmatrixj_1  j_2  j_3  j_4  j_5  j_6  j_7  j_8  j_9endBmatrix = P_0sum_t P(t) left(sum_x A(tx)right) left(sum_y B(ty)right) left(sum_z C(tz)right)","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"It deserves to be mentioned that, although the formula has 4 sums, the sum of xyz are decoupled. So we can do the three for loops respectively, which means the depth of for loop is not 4 but 2.","category":"page"},{"location":"wigner/#Estimate-the-capacity","page":"Wigner Symbols","title":"Estimate the capacity","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Assume we are doing a calculation for a system, we will not calculate the Winger Symbols with very large angular momentum, because usually we will take some trunction. If in such truncated system, the max angular momentum is J_max, now we can estimate how many binomial coefficients we need to store to compute those Wigner Symbols.","category":"page"},{"location":"wigner/#With-maximum-J_{max}","page":"Wigner Symbols","title":"With maximum J_max","text":"","category":"section"},{"location":"wigner/#CG-and-3j","page":"Wigner Symbols","title":"CG & 3j","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"According to the formula, the max possible binomial is beginpmatrix J+1  J-2j_3endpmatrix, where J = j_1+j_2+j_3. So we need at least store binomials to beginpmatrix n_min  kendpmatrix where","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"n_min geq 3J_max+1","category":"page"},{"location":"wigner/#6j-and-Racha","page":"Wigner Symbols","title":"6j & Racha","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"For binomials in sqrt，the maximum possible n = 3J_max+1, and for those in the summation, we have to calculate the boundary of x + 1. According to the formula","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"x leq minj_1+j_2+j_4+j_5 j_1+j_3+j_4+j_6 j_2+j_3+j_5+j_6 leq 4J_max","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"So we have to at least store to","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"n_min geq 4J_max + 1","category":"page"},{"location":"wigner/#9j","page":"Wigner Symbols","title":"9j","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Similarly, according to P_0, we need 3J_max+1. According to P(t),","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"t leq minj_2 + j_6 j_4 + j_8 j_1 + j_9 leq 2J_max","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"so we need j_1 + j_9 + t + 1 leq 4J_max + 1. According to A(t x) B(t y) C(t z),","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"x leq minj_1+j_2+j_6+j_9 j_1+j_3+j_6+t j_2+j_3+j_9+t leq 5J_max","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"so we need to at least store to","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"n_min geq 5J_max + 1","category":"page"},{"location":"wigner/#With-maximum-single-particle-j_{max}","page":"Wigner Symbols","title":"With maximum single particle j_max","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Considering a quantum many body calculation, we can get a more optimistic estimation of the calculation capacity. In a quantum many body calculation, we often truncate single particle orbits, and in this condition we assume that we only need to consider two-body coupled angular momentum.","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"The maximum angular momentum of the single particle orbits defined as j_max. If for each function, there are at least one of the parameters is single particle angular momentum, then we can get the following estimation.","category":"page"},{"location":"wigner/#CG-and-3j-2","page":"Wigner Symbols","title":"CG & 3j","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"In this condition, the j_1 j_2 j_3 contains two single particle angular momentum, and the rest one is a coupled two body angular momentum. So","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"n_min geq 4j_max + 1","category":"page"},{"location":"wigner/#6j-and-Racha-2","page":"Wigner Symbols","title":"6j & Racha","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Similarly","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"x leq minj_1+j_2+j_4+j_5 j_1+j_3+j_4+j_6 j_2+j_3+j_5+j_6","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"These summations of four angular momentum can be split into two kinds, all single particle angular momentum, and two single particle with two two body angular momentum. Consider the worst condition","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"n_min geq 6j_max + 1","category":"page"},{"location":"wigner/#9j-2","page":"Wigner Symbols","title":"9j","text":"","category":"section"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"We assume the 9j symbol contains at least one single particle angular momentum, then according to the coupling rules, the 9j symbol can be split into kinds","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"beginBmatrix\n1  1  2 \n1  1  2 \n2  2  2\nendBmatrix\nquad\nbeginBmatrix\n1  1  2 \n1  2  1 \n2  1  1\nendBmatrix","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"where 1 represents single particle and 2 for two body angular momentum. In both cases, we can deduce that","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"n_min geq 8j_max + 1","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"Reference","category":"page"},{"location":"wigner/","page":"Wigner Symbols","title":"Wigner Symbols","text":"[1]: A. N. Moskalev D. A. Varshalovich and V. K. Khersonskii, Quantum theory of angular momentum.","category":"page"}]
}
